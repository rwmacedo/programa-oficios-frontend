<div class="container-fluid mt-5 bg-primary">
  <div class="row justify-content-center">
    <div class="col-md-10">
      <!-- Container para o conteúdo -->
      <div class="content-box p-4 shadow-sm bg-white rounded">
        <h2 class="text-primary text-center mb-4">Lista de Ofícios</h2>

        <!-- Tabela de Ofícios com paginação e rolagem horizontal em telas menores -->
        <div class="table-responsive">
          <ngx-datatable
            class="bootstrap"
            [rows]="filteredOficios"
            [columnMode]="'force'"
            [headerHeight]="50"
            [footerHeight]="50"
            [rowHeight]="50"
            [limit]="pageSize"
            [count]="filteredOficios.length"
            [offset]="pageOffset"
            (page)="onPage($event)"
            [scrollbarH]="true"
            style="min-width: 1000px;"
          >
            <ngx-datatable-column name="Número" prop="numero" [width]="20"></ngx-datatable-column>
            <ngx-datatable-column name="Ano" prop="ano" [width]="20"></ngx-datatable-column>
            <ngx-datatable-column name="Unidade" prop="unidade" [width]="20"></ngx-datatable-column>
            <ngx-datatable-column name="Data" prop="data" [pipe]="datePipe" [width]="20">
              <ng-template let-row="row" ngx-datatable-cell-template>
                {{ row.data | date: 'dd/MM/yyyy' }}
              </ng-template>
            </ngx-datatable-column>
            <ngx-datatable-column name="Ações">
              <ng-template let-row="row" ngx-datatable-cell-template>
                <button class="btn btn-primary me-1" [routerLink]="['/edit', row.id]">Editar</button>
                <button class="btn btn-danger me-1" (click)="deleteOficio(row.id)">Excluir</button>
                <button class="btn btn-info" *ngIf="row.arquivoUrl" (click)="downloadFile(getFileNameFromUrl(row.arquivoUrl))">Download</button>
              </ng-template>
            </ngx-datatable-column>

            <ngx-datatable-footer>
              <ng-template ngx-datatable-footer-template>
                <div class="d-flex justify-content-end align-items-center custom-paginator">
                  <div>
                    <button (click)="goToFirstPage()">Primeira</button>
                    <button (click)="goToPreviousPage()" [disabled]="pageOffset === 0">Anterior</button>
                  </div>
                  <div class="page-numbers mx-3">
                    <span *ngFor="let page of getPages()">
                      <button (click)="goToPage(page)" [class.active]="page === currentPage">{{ page + 1 }}</button>
                    </span>
                  </div>
                  <div>
                    <button (click)="goToNextPage()" [disabled]="isLastPage()">Próxima</button>
                    <button (click)="goToLastPage()">Última</button>
                  </div>
                </div>
              </ng-template>
            </ngx-datatable-footer>

          </ngx-datatable>
          
        </div>

        <!-- Botão "Novo Ofício" alinhado abaixo da tabela -->
        <div class="d-flex justify-content-start mt-3">
          <button class="btn btn-success btn-novo-oficio" [routerLink]="['/new']">Novo Ofício</button>
        </div>

        <!-- Controles de Paginação e Seleção de Tamanho da Página -->
        <div class="d-flex justify-content-between mt-3">
          <div>
            <label for="pageSize">Linhas por página:</label>
            <select [(ngModel)]="pageSize" (ngModelChange)="onPageSizeChange($event)" class="form-control d-inline-block w-auto">
              <option *ngFor="let size of pageSizes" [value]="size">{{ size }}</option>
            </select>
          </div>
        <!-- Campos de Pesquisa -->
        <div class="row mb-3">
          <div class="col-md-4">
            <input
              type="text"
              placeholder="Pesquisar por Número"
              class="form-control"
              [(ngModel)]="searchTerm"
              (input)="filterOficios()"
            />
          </div>
          <div class="col-md-4">
            <input
              type="number"
              placeholder="Pesquisar por Ano"
              class="form-control"
              [(ngModel)]="selectedAno"
              (input)="filterOficios()"
            />
          </div>
          <div class="col-md-4">
            <input
              type="text"
              placeholder="Pesquisar por Unidade"
              class="form-control"
              [(ngModel)]="selectedUnidade"
              (input)="filterOficios()"
            />
          </div>
        </div>

        </div>
      </div>
    </div>
  </div>
</div>
